# 常见问题与故障排除

本文档收集了项目开发和使用过程中遇到的常见问题及解决方案。

## 开发环境问题

### Q1: 开发环境下 API 请求跨域？

**A**: 开发服务器已配置代理，无需手动处理跨域。如仍有问题，检查 `vite.config.ts` 中的代理配置。

### Q2: 构建失败，类型检查错误？

**A**: 运行 `pnpm type-check` 查看具体错误，修复类型问题后再构建。或使用 `pnpm build-only` 跳过类型检查。

### Q3: 移动端样式异常？

**A**: 检查响应式断点是否正确，使用浏览器开发者工具检查不同屏幕尺寸下的样式。

## 生产环境问题

### Q4: 生产环境 API 请求失败？

**A**: 
- 检查环境变量 `VITE_API_BASE_URL` 是否正确配置
- 检查后端 CORS 配置
- 确认后端服务正常运行

### Q5: 构建产物过大？

**A**: 
- 检查是否有未使用的依赖
- 使用代码分割优化
- 启用生产环境压缩

## 功能相关问题

### Q6: BGM 导入功能无法使用？

**A**: 
- 检查后端 BGM 导入接口是否正常
- 查看浏览器控制台的错误信息
- 确认网络连接正常

### Q7: 图片上传失败？

**A**: 
- 检查文件大小是否超出限制
- 确认后端接口正常
- 查看浏览器控制台错误信息

### Q8: 搜索功能触发限流？

**A**: 
- 搜索已使用 300ms 防抖，但频繁快速输入仍可能触发限流
- 建议等待几秒后重试
- 检查后端限流阈值配置

## 移动端问题

### Q9: 移动端原生功能无法使用（相机、文件系统等）？

**A**: 
- 确认已安装对应的 Capacitor 插件
- 运行 `npx cap sync` 同步插件到原生项目
- 检查原生项目中的权限配置
- 在真实设备上测试（模拟器可能不支持部分功能）

### Q10: 移动端 Live Reload 不工作？

**A**: 
- 确保设备和电脑在同一网络
- 检查防火墙设置
- 使用 `npx cap run -l --external` 启动，确保使用了正确的 IP 地址

## 环境配置问题

### Q11: 环境变量不生效？

**A**: 
- 确认 `.env` 文件在项目根目录
- 环境变量必须以 `VITE_` 开头
- 修改环境变量后需要重启开发服务器

### Q12: 后端地址配置不生效？

**A**: 
- 检查设置页中的后端地址配置
- 确认 `localStorage` 中的键名正确（`pickgoods_api_base_url`）
- 检查浏览器控制台是否有错误信息

## 性能问题

### Q13: 首屏加载慢？

**A**: 
- 检查网络连接
- 确认后端接口响应时间
- 检查是否有大量同步请求
- 使用浏览器性能分析工具定位问题

### Q14: 页面切换卡顿？

**A**: 
- 检查是否有未清理的定时器或事件监听器
- 确认数据请求是否使用了合适的缓存策略
- 使用 Vue DevTools 检查组件渲染性能

## 依赖问题

### Q15: 依赖安装失败？

**A**: 
- 清除缓存：`pnpm store prune`
- 删除 `node_modules` 和锁文件后重新安装
- 检查 Node.js 和 pnpm 版本是否符合要求

### Q16: 类型定义缺失？

**A**: 
- 运行 `pnpm install` 确保所有依赖已安装
- 检查 `src/api/types.ts` 中的类型定义是否完整
- 使用 `pnpm type-check` 检查类型错误

## 浏览器兼容性

### Q17: 某些浏览器功能异常？

**A**: 
- 检查浏览器版本是否符合要求（Chrome 90+、Firefox 88+、Safari 14+、Edge 90+）
- 使用浏览器开发者工具检查控制台错误
- 确认浏览器是否支持所需的 Web API

## 获取帮助

如果以上问题都无法解决，可以：

1. 查看项目 GitHub Issues
2. 检查相关依赖的官方文档
3. 查看浏览器控制台的详细错误信息
4. 联系项目维护者

---

*本文档持续更新，如有新问题请及时反馈。*
